version: "1.0"

backend:
  type: claude

loop:
  max_iterations: 50
  completion_promise: "LOOP_COMPLETE"

hats:
  planner:
    name: "üìã Planner"
    triggers: ["task.start"]
    publishes: ["plan.ready"]
    instructions: |
      You are the PLANNER hat. Your job is to analyze and plan.
      
      Tasks:
      1. Analyze the issue requirements thoroughly
      2. Break down into small, testable steps
      3. Identify dependencies and risks
      4. Write a clear implementation plan in scratchpad
      
      When plan is ready:
      - Output: EVENT: plan.ready

  builder:
    name: "üî® Builder"
    triggers: ["plan.ready", "review.revise"]
    publishes: ["build.done"]
    instructions: |
      You are the BUILDER hat. Your job is to implement the plan.
      
      Tasks:
      1. Follow the plan in scratchpad
      2. Implement step by step
      3. Write tests alongside implementation
      4. Update scratchpad with progress
      
      When implementation is done:
      - Output: EVENT: build.done

  reviewer:
    name: "üîç Reviewer"
    triggers: ["build.done"]
    publishes: ["review.approved", "review.revise", "LOOP_COMPLETE"]
    instructions: |
      You are the REVIEWER hat. Your job is to verify quality.
      
      Check:
      1. Does code meet all requirements?
      2. Are tests comprehensive?
      3. Is code clean and maintainable?
      4. Any bugs or edge cases missed?
      
      Decisions:
      - If issues found: EVENT: review.revise
      - If quality is good: EVENT: review.approved
      - If complete and ready for PR: EVENT: LOOP_COMPLETE

gates:
  after_plan: true
  after_implementation: false
  before_pr: true

state:
  use_github_labels: true
  use_scratchpad: true
