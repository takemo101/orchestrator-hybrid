# TDD preset - テスト駆動開発 (Red -> Green -> Refactor)
#
# Hatシステムを使用して TDD サイクルを強制。
# ワークフロー:
# 1. Tester: テストを書く -> tests.failing
# 2. Implementer: テストを通す実装 -> code.written
# 3. Tester: テスト再実行 -> tests.passing
# 4. Refactorer: リファクタリング -> LOOP_COMPLETE

preset: tdd

# Hat定義
hats:
  tester:
    name: "Tester"
    triggers:
      - task.start
      - code.written
    publishes:
      - tests.failing
      - tests.passing
    instructions: |
      あなたはテスターです。
      - task.start: 要件に基づいてテストを作成してください。テストは失敗することを確認し、tests.failing を出力してください。
      - code.written: 実装後、テストを再実行してください。全テスト通過なら tests.passing、失敗なら tests.failing を出力してください。

  implementer:
    name: "Implementer"
    triggers:
      - tests.failing
    publishes:
      - code.written
    instructions: |
      あなたは実装者です。
      失敗しているテストを通すための最小限のコードを実装してください。
      実装完了後、code.written を出力してください。

  refactorer:
    name: "Refactorer"
    triggers:
      - tests.passing
    publishes:
      - code.written
      - LOOP_COMPLETE
    instructions: |
      あなたはリファクタラーです。
      テストが通っている状態で、コードの品質を向上させてください。
      - リファクタリングが必要な場合: code.written を出力してください。
      - 完了した場合: LOOP_COMPLETE を出力してください。
